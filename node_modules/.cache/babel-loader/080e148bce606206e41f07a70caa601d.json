{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/cathychen/Desktop/WebProgramming/NTU-WebProgramming-FinalProject/love_diary/src/components/Login/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { NavLink, Switch, Route, Redirect } from \"react-router-dom\";\nimport CryptoJs from 'crypto-js';\nimport SignUpButton from './SignUpButton';\nimport moment from 'moment';\nimport Fade from '@material-ui/core/Fade';\nimport axios from 'axios';\nimport \"./Login.css\";\nconst API_ROOT = 'http://localhost:4000/api';\nconst instance = axios.create({\n  baseURL: API_ROOT\n});\n\nfunction Login({\n  loginSuccess\n}) {\n  _s();\n\n  const [myAccount, setAccount] = useState(\"\");\n  const [myPassword, setPassword] = useState(\"\");\n  const [allAccounts, setAllAccounts] = useState([]);\n  const [updateAccounts, setUpdateAccounts] = useState(0);\n  const [initAcc, setInitAcc] = useState(null);\n\n  const addAccount = async (acc, pw, name1, name2, date) => {\n    var newAcc = {\n      account: acc,\n      password: pw,\n      name1: name1,\n      name2: name2,\n      date: date\n    };\n    const {\n      data: {\n        message\n      }\n    } = await instance.post('/addAccount', {\n      params: newAcc\n    });\n\n    if (message === \"success\") {\n      setUpdateAccounts(updateAccounts + 1);\n      setInitAcc(newAcc);\n    }\n\n    return message;\n  };\n\n  const handleSubmit = () => {\n    if (myAccount === \"\" || myPassword === \"\") {\n      alert(\"Please enter your Account Name and Password\");\n    } else {\n      const pwd = CryptoJs.MD5(myPassword).toString();\n      var myAcc = allAccounts.filter(acc => acc.account === myAccount && acc.password === pwd);\n\n      if (myAcc.length === 0) {\n        alert(\"Your Account Name or Password is wrong!\");\n      } else {\n        // var loginUI = document.getElementsByClassName(\"closedBook\")[0];\n        // console.log(loginUI);\n        // loginUI.setAttribute(\"id\", \"hide\");\n        loginSuccess(myAcc[0]._id, myAcc[0].name1, myAcc[0].name2, myAcc[0].date);\n      }\n    }\n  };\n\n  const getAccounts = async () => {\n    const {\n      data: {\n        message,\n        accounts\n      }\n    } = await instance.get('/getAccounts');\n\n    if (message === 'success') {\n      //console.log(\"accounts: \"+accounts);\n      setAllAccounts(accounts);\n    } else {\n      alert(\"Error happens!\");\n    }\n  };\n\n  const initAccount = async () => {\n    if (initAcc !== null) {\n      var acc = initAcc.account;\n      const {\n        data: {\n          accountId\n        }\n      } = await instance.get('/findAccount', {\n        params: {\n          acc\n        }\n      }); //console.log(accountId);\n\n      const end = moment(initAcc.date).add(1, \"days\").format(\"YYYY-MM-DD\");\n      var event = {\n        accountId: accountId,\n        title: \"First Day\",\n        favorite: true,\n        todo: false,\n        start: initAcc.date,\n        end: end,\n        textColor: \"white\",\n        backgroundColor: \"#F6919D\",\n        borderColor: \"#F6919D\"\n      };\n      const {\n        data: {\n          message\n        }\n      } = await instance.post('/addFirstEvent', {\n        params: {\n          event\n        }\n      });\n      if (message === \"error\") console.log(\"initAccount error\");\n    }\n  };\n\n  useEffect(() => {\n    getAccounts();\n  }, [updateAccounts]);\n  useEffect(() => {\n    initAccount();\n  }, [initAcc]);\n  return /*#__PURE__*/_jsxDEV(Fade, {\n    in: true,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"closedBook\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"login_title\",\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"acc_pas\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"account\",\n            className: \"account\",\n            children: \"Account : \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"account\",\n            id: \"account\",\n            className: \"login_type\",\n            value: myAccount,\n            onChange: e => setAccount(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"password\",\n            className: \"password\",\n            children: \"Password : \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            name: \"password\",\n            id: \"password\",\n            className: \"login_type\",\n            value: myPassword,\n            onChange: e => setPassword(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSubmit,\n          type: \"button\",\n          className: \"open\",\n          children: \"Open\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(SignUpButton, {\n          addAccount: addAccount\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Login, \"GuJhUuZ6/YFeyEwjkb651lN8FG0=\");\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/cathychen/Desktop/WebProgramming/NTU-WebProgramming-FinalProject/love_diary/src/components/Login/Login.js"],"names":["React","useState","useEffect","NavLink","Switch","Route","Redirect","CryptoJs","SignUpButton","moment","Fade","axios","API_ROOT","instance","create","baseURL","Login","loginSuccess","myAccount","setAccount","myPassword","setPassword","allAccounts","setAllAccounts","updateAccounts","setUpdateAccounts","initAcc","setInitAcc","addAccount","acc","pw","name1","name2","date","newAcc","account","password","data","message","post","params","handleSubmit","alert","pwd","MD5","toString","myAcc","filter","length","_id","getAccounts","accounts","get","initAccount","accountId","end","add","format","event","title","favorite","todo","start","textColor","backgroundColor","borderColor","console","log","e","target","value"],"mappings":"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","sourcesContent":["import React , { useState, useEffect }from \"react\";\nimport { NavLink, Switch, Route, Redirect } from \"react-router-dom\";\nimport CryptoJs from 'crypto-js';\nimport SignUpButton from './SignUpButton'\nimport moment from 'moment';\nimport Fade from '@material-ui/core/Fade';\n\nimport axios from 'axios'\nimport \"./Login.css\"\n\nconst API_ROOT = 'http://localhost:4000/api'\nconst instance = axios.create({\n  baseURL: API_ROOT\n})\n\nfunction Login({loginSuccess}){\n    const[myAccount, setAccount] = useState(\"\");\n    const[myPassword, setPassword] = useState(\"\");\n    const[allAccounts, setAllAccounts] = useState([]);\n    const[updateAccounts, setUpdateAccounts] = useState(0);\n    const[initAcc, setInitAcc] = useState(null);\n    \n    const addAccount = async(acc, pw, name1, name2, date) =>{\n        var newAcc = {\n            account: acc,\n            password: pw,\n            name1: name1,\n            name2: name2,\n            date: date\n        } \n        const {\n            data: { message}\n        } = await instance.post('/addAccount', { params: newAcc });\n        \n        if(message === \"success\" ){\n            setUpdateAccounts(updateAccounts+1);\n            setInitAcc(newAcc);\n        }\n        return message;\n    }\n\n    const handleSubmit = () => {\n        if(myAccount === \"\" || myPassword === \"\"){\n            alert(\"Please enter your Account Name and Password\")\n        }else{\n            const pwd = CryptoJs.MD5(myPassword).toString();           \n            var myAcc = allAccounts.filter(acc => (acc.account === myAccount && acc.password === pwd));\n            if(myAcc.length === 0){\n                alert(\"Your Account Name or Password is wrong!\");\n            }else{\n                // var loginUI = document.getElementsByClassName(\"closedBook\")[0];\n                // console.log(loginUI);\n                // loginUI.setAttribute(\"id\", \"hide\");\n                loginSuccess(myAcc[0]._id, myAcc[0].name1, myAcc[0].name2, myAcc[0].date);\n            }\n        }\n    }\n\n    const getAccounts = async() => {\n        const {\n            data: { message, accounts }\n        } = await instance.get('/getAccounts');\n        if(message === 'success'){\n            //console.log(\"accounts: \"+accounts);\n            setAllAccounts(accounts);\n        }else{\n            alert(\"Error happens!\");\n        }\n    }\n\n    const initAccount = async()=>{\n        if(initAcc !== null){\n            var acc = initAcc.account;\n            const {\n                data: { accountId}\n            } = await instance.get('/findAccount', { params: {acc} });\n            //console.log(accountId);\n            const end = moment(initAcc.date).add(1,\"days\").format(\"YYYY-MM-DD\");\n            var event = {\n                accountId:accountId, \n                title: \"First Day\",\n                favorite: true,\n                todo: false,\n                start: initAcc.date,\n                end: end,\n                textColor: \"white\",\n                backgroundColor:\"#F6919D\",\n                borderColor:\"#F6919D\"\n            }\n            const {\n                data: { message }\n            } = await instance.post('/addFirstEvent', { params: { event } });\n            if(message===\"error\") console.log(\"initAccount error\");\n        }\n    }\n\n    useEffect(() => {\n        getAccounts();\n    },[updateAccounts]);\n\n    useEffect(()=>{\n        initAccount();\n    },[initAcc]);\n    \n    return(\n        <Fade in={true}>\n        <div className=\"closedBook\">\n            <p className=\"login_title\">Login</p>\n            <form>\n                <div className=\"acc_pas\">\n                    <label htmlFor=\"account\" className=\"account\">Account : </label>\n                    <input type=\"text\" name=\"account\" id=\"account\" className=\"login_type\"\n                        value={myAccount}\n                        onChange={(e) => setAccount(e.target.value)}\n                    ></input>\n                    <p></p>\n                    <label htmlFor=\"password\" className=\"password\">Password : </label>\n                    <input type=\"password\" name=\"password\" id=\"password\" className=\"login_type\"\n                        value={myPassword}\n                        onChange={(e) => setPassword(e.target.value)}\n                    ></input>\n                </div>\n                <button onClick={handleSubmit} type=\"button\" className=\"open\" >Open</button>\n                <SignUpButton addAccount={addAccount}></SignUpButton>\n            </form>\n        </div>\n        </Fade>\n    )\n    \n}\nexport default Login;\n\n"]},"metadata":{},"sourceType":"module"}