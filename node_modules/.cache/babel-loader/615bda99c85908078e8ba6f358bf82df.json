{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/cathychen/Desktop/WebProgramming/NTU-WebProgramming-FinalProject/love_diary/src/components/Diary/PicturesWall.js\",\n    _s = $RefreshSig$();\n\nimport { React, useState, useEffect } from 'react';\nimport axios from 'axios';\nconst API_ROOT = 'http://localhost:4000/api';\nconst instance = axios.create({\n  baseURL: API_ROOT\n});\nexport default function PicturesWall({\n  dateStr,\n  accountId,\n  photoText,\n  photoText_onChange\n}) {\n  _s();\n\n  const [imageUrl, setImageUrl] = useState(\"\");\n  const [isInDatabase, setIsInDatabase] = useState(false);\n\n  const _getPhoto = async () => {\n    const {\n      data: {\n        message,\n        url\n      }\n    } = await instance.get('/getPhoto', {\n      params: {\n        accountId,\n        dateStr\n      }\n    });\n\n    if (message === \"exist\") {\n      setImageUrl(url);\n      setIsInDatabase(true);\n    } else {\n      setImageUrl(\"\");\n      setIsInDatabase(false);\n    }\n  };\n\n  useEffect(() => {\n    if (dateStr !== undefined) {\n      _getContent();\n    }\n  }, [dateStr]);\n\n  const uploadImage = ({}) => {\n    const r = new XMLHttpRequest();\n    const d = new FormData();\n    const e = document.getElementsByClassName('input-image')[0].files[0];\n    var u;\n    d.append('image', e);\n    r.open('POST', 'https://api.imgur.com/3/image/');\n    r.setRequestHeader('Authorization', `Client-ID 4e3b0d0edce7854`);\n\n    r.onreadystatechange = function () {\n      if (r.status === 200 && r.readyState === 4) {\n        let res = JSON.parse(r.responseText);\n        u = `https://i.imgur.com/${res.data.id}.png`;\n      }\n\n      setImageUrl(u);\n      console.log(u);\n    };\n\n    r.send(d);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [imageUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n      className: \"photo\",\n      alt: \"photo\",\n      src: imageUrl\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 18\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), /*#__PURE__*/_jsxDEV(\"label\", {\n      for: \"fileinp\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        id: \"btn\",\n        value: \"\\u9EDE\\u6211\\u4E0A\\u50B3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        id: \"fileinp\",\n        className: \"input-image\",\n        onChange: uploadImage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n      value: photoText,\n      onChange: photoText_onChange,\n      placeholder: \"Someting about the photo...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(PicturesWall, \"S8TquenKjl9B0N8YVq3STnwsg+o=\");\n\n_c = PicturesWall;\n\nvar _c;\n\n$RefreshReg$(_c, \"PicturesWall\");","map":{"version":3,"sources":["/Users/cathychen/Desktop/WebProgramming/NTU-WebProgramming-FinalProject/love_diary/src/components/Diary/PicturesWall.js"],"names":["React","useState","useEffect","axios","API_ROOT","instance","create","baseURL","PicturesWall","dateStr","accountId","photoText","photoText_onChange","imageUrl","setImageUrl","isInDatabase","setIsInDatabase","_getPhoto","data","message","url","get","params","undefined","_getContent","uploadImage","r","XMLHttpRequest","d","FormData","e","document","getElementsByClassName","files","u","append","open","setRequestHeader","onreadystatechange","status","readyState","res","JSON","parse","responseText","id","console","log","send"],"mappings":"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","sourcesContent":["import {React, useState, useEffect} from 'react';\nimport axios from 'axios'\n\nconst API_ROOT = 'http://localhost:4000/api'\nconst instance = axios.create({\n  baseURL: API_ROOT\n})\nexport default function PicturesWall({dateStr, accountId, photoText, photoText_onChange}){\n  const [imageUrl, setImageUrl] = useState(\"\");\n  const [isInDatabase, setIsInDatabase] = useState(false);\n\n    const _getPhoto = async() =>{\n        const {\n            data: { message, url}\n        } = await instance.get('/getPhoto',{ params: { accountId, dateStr}});\n        if(message===\"exist\"){\n            setImageUrl(url);\n            setIsInDatabase(true);\n        }else{\n            setImageUrl(\"\");\n            setIsInDatabase(false);\n        }\n    }\n\n    useEffect(()=>{\n      if(dateStr!==undefined){\n          _getContent();\n      }\n    },[dateStr]);\n\n\n  const uploadImage = ({}) => {\n    const r = new XMLHttpRequest()\n    const d = new FormData()\n    const e = document.getElementsByClassName('input-image')[0].files[0]\n    var u\n\n    d.append('image', e)\n\n    r.open('POST', 'https://api.imgur.com/3/image/')\n    r.setRequestHeader('Authorization', `Client-ID 4e3b0d0edce7854`)\n    r.onreadystatechange = function () {\n      if(r.status === 200 && r.readyState === 4) {\n        let res = JSON.parse(r.responseText)\n        u = `https://i.imgur.com/${res.data.id}.png`\n      }      \n      setImageUrl(u);\n      console.log(u);\n    }\n    r.send(d);\n  }\n\n  return (\n    <>\n      {imageUrl? <img className=\"photo\" alt=\"photo\" src={imageUrl}/>:<></>}\n      <label for=\"fileinp\">\n        <input type=\"button\" id=\"btn\" value=\"點我上傳\"/>\n        <input type=\"file\" id=\"fileinp\" className=\"input-image\" onChange={uploadImage}/>\n      </label>\n      <textarea value={photoText} onChange={photoText_onChange} placeholder=\"Someting about the photo...\"></textarea>\n    </>\n  );\n}"]},"metadata":{},"sourceType":"module"}