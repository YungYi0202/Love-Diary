{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/cathychen/Desktop/WebProgramming/NTU-WebProgramming-FinalProject/love_diary/src/components/Diary/PicturesWall.js\",\n    _s = $RefreshSig$();\n\nimport { Upload, Modal } from 'antd';\nimport { PlusOutlined } from '@ant-design/icons';\nimport { React, Component, useReducer } from 'react';\nimport { Input } from 'antd';\nconst {\n  TextArea\n} = Input;\n\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onload = () => resolve(reader.result);\n\n    reader.onerror = error => reject(error);\n  });\n}\n\nclass TextInput extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      value: ''\n    };\n\n    this.onChange = ({\n      target: {\n        value\n      }\n    }) => {\n      this.setState({\n        value\n      });\n    };\n  }\n\n  render() {\n    const {\n      value\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(TextArea, {\n      value: value,\n      onChange: this.onChange,\n      placeholder: \"Something with this image.\",\n      autoSize: {\n        minRows: 3,\n        maxRows: 3\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 9\n    }, this);\n  }\n\n}\n\nconst todoReducer = (state, action) => {\n  // 判斷指令\n  switch (action.type) {\n    case 'cancel':\n      return { ...state,\n        previewVisible: false\n      };\n\n    case 'preview':\n      return { ...state,\n        previewImage: action.payload.file.url || action.payload.file.preview,\n        previewVisible: true\n      };\n\n    case 'change':\n      return { ...state,\n        fileList: action.payload.list\n      };\n\n    default:\n      return state;\n  }\n}; // 初始資料，為 state 的初始值，通常會在這裡把結構描述完整\n\n\nconst initState = {\n  previewVisible: false,\n  previewImage: '',\n  previewTitle: '',\n  fileList: []\n};\nexport default function PicturesWall() {\n  _s();\n\n  const [state, dispatch] = useReducer(todoReducer, initState);\n\n  const handleCancel = () => dispatch({\n    type: 'cancel'\n  });\n\n  const handlePreview = async file => {\n    if (!file.url && !file.preview) {\n      file.preview = await getBase64(file.originFileObj);\n    }\n\n    dispatch({\n      type: 'preview',\n      payload: {\n        file: file\n      }\n    });\n  };\n\n  const handleChange = ({\n    fileList\n  }) => {\n    console.log(fileList);\n    dispatch({\n      type: 'change',\n      payload: {\n        list: fileList\n      }\n    });\n  };\n\n  const uploadButton = /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"photo\",\n      style: {\n        marginTop: 8\n      },\n      children: \"Upload\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n\n  const SERVER_URL = 'http://localhost:8000';\n  const UPLOAD_URL = `${SERVER_URL}/upload`;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Upload, {\n      action: UPLOAD_URL,\n      listType: \"picture-card\",\n      fileList: state.fileList,\n      onPreview: handlePreview,\n      onChange: handleChange,\n      children: state.fileList.length >= 1 ? null : uploadButton\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      visible: state.previewVisible,\n      title: state.previewTitle,\n      footer: null,\n      onCancel: handleCancel,\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        alt: \"photo\",\n        style: {\n          width: '100%'\n        },\n        src: state.previewImage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TextInput, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(PicturesWall, \"ivzsx5aR9qRFuEtyOcndflQiQ1Q=\");\n\n_c = PicturesWall;\n\nvar _c;\n\n$RefreshReg$(_c, \"PicturesWall\");","map":{"version":3,"sources":["/Users/cathychen/Desktop/WebProgramming/NTU-WebProgramming-FinalProject/love_diary/src/components/Diary/PicturesWall.js"],"names":["Upload","Modal","PlusOutlined","React","Component","useReducer","Input","TextArea","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","TextInput","state","value","onChange","target","setState","render","minRows","maxRows","todoReducer","action","type","previewVisible","previewImage","payload","url","preview","fileList","list","initState","previewTitle","PicturesWall","dispatch","handleCancel","handlePreview","originFileObj","handleChange","console","log","uploadButton","marginTop","SERVER_URL","UPLOAD_URL","length","width"],"mappings":"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","sourcesContent":["import { Upload, Modal } from 'antd';\nimport { PlusOutlined } from '@ant-design/icons';\nimport {React, Component, useReducer} from 'react';\nimport { Input } from 'antd';\n\n\nconst { TextArea } = Input;\n\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = error => reject(error);\n  });\n}\n\nclass TextInput extends Component {\n  state = {\n    value: '',\n  };\n\n  onChange = ({ target: { value } }) => {\n    this.setState({ value });\n  };\n\n  render() {\n    const { value } = this.state;\n    return (\n        <TextArea\n          value={value}\n          onChange={this.onChange}\n          placeholder=\"Something with this image.\"\n          autoSize={{ minRows: 3, maxRows: 3 }}\n        />\n    );\n  }\n}\n\nconst todoReducer = (state, action) => {\n  // 判斷指令\n  switch (action.type) {\n      case 'cancel':\n        return{ ...state, previewVisible: false }\n      case 'preview':\n        return{\n          ...state,\n          previewImage: action.payload.file.url || action.payload.file.preview,\n          previewVisible: true\n        }\n      case 'change':\n        return{\n          ...state,\n          fileList: action.payload.list\n        }\n      default:\n          return state\n  }\n}\n\n// 初始資料，為 state 的初始值，通常會在這裡把結構描述完整\nconst initState = {\n  previewVisible: false,\n  previewImage: '',\n  previewTitle: '',\n  fileList: [],\n}\n\nexport default function PicturesWall(){\n  const [state, dispatch] = useReducer(todoReducer, initState);\n\n  const handleCancel = () => dispatch({ type: 'cancel'});\n\n  const handlePreview = async file => {\n    if (!file.url && !file.preview) {\n      file.preview = await getBase64(file.originFileObj);\n    }\n\n    dispatch({ type: 'preview', payload: { file: file } });\n  };\n\n  const handleChange = ({ fileList }) => {\n    console.log(fileList);\n    dispatch({ type: 'change', payload: { list: fileList } });\n  }\n\n  const uploadButton = (\n    <div>\n      <PlusOutlined />\n      <div className=\"photo\" style={{ marginTop: 8 }}>Upload</div>\n    </div>\n  );\n\n  const SERVER_URL = 'http://localhost:8000'\n  const UPLOAD_URL = `${SERVER_URL}/upload`\n  return (\n    <>\n      <Upload\n        action={UPLOAD_URL}\n        listType=\"picture-card\"\n        fileList={state.fileList}\n        onPreview={handlePreview}\n        onChange={handleChange}\n        \n      >\n        {state.fileList.length >= 1 ? null : uploadButton}\n      </Upload>\n      <Modal\n        visible={state.previewVisible}\n        title={state.previewTitle}\n        footer={null}\n        onCancel={handleCancel}\n      >\n        <img alt=\"photo\" style={{ width: '100%' }} src={state.previewImage} />\n      </Modal>\n      <TextInput />\n    </>\n  );\n}"]},"metadata":{},"sourceType":"module"}